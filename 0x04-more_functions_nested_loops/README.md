more function and more nested loop
